<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>ğŸ¸ GOG â€” ã‚ªãƒ¼ãƒ€ãƒ¼è¨ˆç®—ãƒ„ãƒ¼ãƒ«ï¼ˆã‚¹ãƒãƒ›/PCå¯¾å¿œï¼‰</title>

<style>
  :root{
    --gold:#c9a227;
    --muted:#d9cfc6;
    --navy:#0b1530;
    --card-bg:#0f1726;
    --btn-size-desktop:40px;
    --btn-size-mobile:54px;
    --radius:12px;
    --danger:#b94a4a;
  }

  *{box-sizing:border-box;}
  html,body{height:100%; margin:0;}

  body{
    padding:20px;
    padding-bottom:260px; /* ãƒ•ãƒƒã‚¿ãƒ¼ã¶ã‚“ä½™ç™½ã‚’ç¢ºä¿ã—ã¦ã‹ã¶ã‚Šé˜²æ­¢ */
    font-family:"Noto Sans JP", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background: linear-gradient(180deg, var(--navy), #071028);
    color:var(--muted);
    -webkit-font-smoothing:antialiased;
    display:flex;
    flex-direction:column;
  }

  main{
    flex:1;
    display:flex;
    flex-direction:column;
    width:100%;
  }

  .container{max-width:1200px; margin:0 auto;}

  /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
  header{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    margin-bottom:14px;
  }
  .title-wrap{display:flex; flex-direction:column;}
  h1{margin:0; color:var(--gold); font-size:20px;}
  .subtitle{font-size:13px; color:#d6c99a;}

  /* ãƒœã‚¿ãƒ³é¡ */
  .btn{
    background:#2b2330;
    color:var(--muted);
    border:1px solid rgba(255,255,255,0.08);
    border-radius:10px;
    padding:8px 10px;
    cursor:pointer;
    font-size:14px;
  }
  .btn:hover{filter:brightness(1.05); color:var(--gold);}
  .small{font-size:13px; padding:6px 9px;}

  .top-controls{display:flex; gap:8px; align-items:center; flex-wrap:wrap;}

  /* ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ */
  .menu-area{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:12px;
  }
  @media (max-width:900px){
    .menu-area{grid-template-columns:1fr;}
  }

  .menu-group{
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12));
    padding:10px;
    border-radius:var(--radius);
    box-shadow:0 8px 24px rgba(0,0,0,0.4);
    border:1px solid rgba(255,255,255,0.05);
    margin-bottom:10px;
  }

  .menu-group-header{
    background: rgba(201,162,39,0.12);
    padding:8px 12px;
    border-radius:10px;
    border:1px solid rgba(201,162,39,0.25);
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:8px;
  }
  .menu-group-header h2{
    margin:0;
    font-size:18px;
    font-weight:900;
    color:var(--gold);
  }

  .menu-item{
    background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.2));
    border-radius:10px;
    padding:8px 10px;
    margin-bottom:6px; /* â† ãƒ¡ãƒ‹ãƒ¥ãƒ¼é–“ã®éš™é–“ã‚’ç‹­ã‚ã‚‹ */
    border:1px solid rgba(255,255,255,0.04);
    display:flex;
    flex-direction:column;
    gap:4px;
  }

  .top-line{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
  }
  .name{font-weight:700; font-size:15px; color:#fff;}
  .price{min-width:80px; text-align:right; color:#efe9d6; font-weight:700; font-size:15px;}

  .qty-label{font-size:12px; color:#d0c6b8;}

  .controls-row{
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
    flex-wrap:wrap;
  }

  .btn-row{
    display:flex;
    align-items:center;
    gap:6px;
    flex-wrap:wrap;
  }

  .qty-btn{
    width:var(--btn-size-desktop);
    height:var(--btn-size-desktop);
    display:grid;
    place-items:center;
    border-radius:8px;
    background:linear-gradient(180deg,#241b16,#3a2b24);
    color:var(--muted);
    border:1px solid rgba(255,255,255,0.08);
    cursor:pointer;
    font-weight:800;
    touch-action:manipulation;
  }

  .qty{
    display:inline-block;
    min-width:52px;
    text-align:center;
    font-weight:800;
    font-size:16px;
    color:#fff;
  }

  /* å‰Šé™¤ãƒœã‚¿ãƒ³ï¼šç·¨é›†ãƒ¢ãƒ¼ãƒ‰ONã®æ™‚ã ã‘è¡¨ç¤º */
  .delete-btn{
    background:transparent;
    border:1px solid rgba(255,255,255,0.35);
    color:var(--muted);
    padding:6px 8px;
    border-radius:8px;
    cursor:pointer;
    font-size:12px;
  }
  body:not(.edit-mode) .delete-btn{
    display:none !important;
  }

  /* é›†è¨ˆã‚¨ãƒªã‚¢ï¼ˆãƒ¡ãƒ¢æ¬„ï¼‰ */
  .summary{
    margin-top:14px;
    background:rgba(255,255,255,0.03);
    border-radius:12px;
    padding:12px;
    border:1px solid rgba(255,255,255,0.04);
  }
  .order-line{
    display:flex;
    justify-content:space-between;
    margin-bottom:6px;
    font-size:14px;
  }
  .total{
    margin-top:6px;
    text-align:right;
    font-size:18px;
    color:#fff;
    font-weight:800;
  }

  /* å›ºå®šãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆåˆè¨ˆï¼‹ãƒªã‚»ãƒƒãƒˆï¼‰ */
  .total-bar{
    position:fixed;
    bottom:0;
    left:0;
    width:100%;
    display:flex;
    justify-content:center;
    z-index:9999;
  }
  .total-bar-inner{
    width:100%;
    max-width:1200px;
    background:linear-gradient(180deg,#c9a227,#9f821d);
    padding:12px 18px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    border-top:2px solid rgba(255,255,255,0.35);
    box-shadow:0 -4px 18px rgba(0,0,0,0.7);
  }
  .total-text{
    font-size:22px;
    font-weight:900;
    color:#fff;
  }
  .reset-btn-footer{
    padding:10px 18px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.6);
    color:#fff;
    background:rgba(0,0,0,0.25);
    cursor:pointer;
  }

  /* ãƒ‡ãƒã‚¤ã‚¹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆãƒ•ãƒƒã‚¿ãƒ¼ã«ã‹ã¶ã‚‰ãªã„ä½ç½®ï¼‰ */
  .device-indicator{
    position:fixed;
    bottom:90px;
    right:12px;
    background:rgba(0,0,0,0.45);
    padding:6px 10px;
    border-radius:8px;
    font-size:12px;
    color:var(--muted);
    z-index:9998;
  }

  /* ãƒ€ã‚¤ã‚¢ãƒ­ã‚° */
  .dialog{
    position:fixed;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    background:rgba(0,0,0,0.6);
    z-index:10000;
  }
  .dialog.hidden{
    display:none !important;
  }
  .dialog-content{
    background:linear-gradient(180deg,#0f1113,#141417);
    padding:16px;
    border-radius:12px;
    width:320px;
    color:var(--muted);
    border:1px solid rgba(255,255,255,0.05);
  }
  .dialog-content input,
  .dialog-content select{
    width:100%;
    padding:8px;
    margin-bottom:8px;
    border-radius:8px;
    border:1px solid rgba(255,255,255,0.15);
    background:transparent;
    color:var(--muted);
  }

  /* ãƒ­ã‚´ã¯éè¡¨ç¤ºï¼ˆã§ã£ã‹ã„ãƒ­ã‚´ã‚’å‡ºã•ãªã„ï¼‰ */
  .top-logo{display:none !important;}

  /* ============================
   ãƒ•ãƒƒã‚¿ãƒ¼é‡ãªã‚Šã‚’é˜²ãä½™ç™½èª¿æ•´
============================ */

/* summaryï¼ˆé¸æŠæ¸ˆã¿å•†å“ä¸€è¦§ï¼‰ãŒãƒ•ãƒƒã‚¿ãƒ¼ã«è¢«ã‚‰ãªã„ã‚ˆã†ã«ä½™ç™½ç¢ºä¿ */
.summary {
  padding-bottom: 220px !important;
}

/* body å…¨ä½“ã®ä¸‹éƒ¨ä½™ç™½ã‚‚ã•ã‚‰ã«ä½™è£•ã‚’æŒãŸã›ã‚‹ */
body {
  padding-bottom: 300px !important;
}

/* ã‚¹ãƒãƒ›æ™‚ã‚‚åŒæ§˜ã«ä½™ç™½ã‚’ç¢ºä¿ */
@media (max-width:600px) {
  .summary {
    padding-bottom: 240px !important;
  }
  body {
    padding-bottom: 300px !important;
  }
}
  
  /* ã‚¹ãƒãƒ›ç”¨èª¿æ•´ï¼ˆãƒ•ã‚©ãƒ³ãƒˆï¼†ãƒœã‚¿ãƒ³å°‘ã—å¤§ãã‚ï¼‹å¯†åº¦UPï¼‰ */
  @media (max-width:600px){
    body{
      padding:12px;
      padding-bottom:260px;
    }
    header{
      flex-direction:column;
      align-items:flex-start;
      gap:8px;
    }
    .name{font-size:17px;}
    .price{font-size:17px;}
    .qty-label{font-size:14px;}
    .qty{font-size:19px;}

    .qty-btn{
      width:50px;
      height:50px;
      font-size:18px;
    }
  }
</style>
</head>

<body>
<main>
  <div class="container">

    <header>
      <div class="title-wrap">
        <h1 id="pageTitle">ğŸ¸ GOG ã‚ªãƒ¼ãƒ€ãƒ¼è¨ˆç®—ãƒ„ãƒ¼ãƒ«</h1>
        <div class="subtitle">ã‚¹ãƒãƒ› / PC è‡ªå‹•åˆ‡æ›¿å¯¾å¿œ</div>
      </div>

      <div class="top-controls">
        <button class="btn small" id="editModeBtn">ç·¨é›†ãƒ¢ãƒ¼ãƒ‰</button>
        <button class="btn small" id="deviceToggleBtn">PC/ã‚¹ãƒãƒ›åˆ‡æ›¿</button>
      </div>
    </header>

    <div id="menuArea" class="menu-area"></div>

    <div id="summary" class="summary"></div>

  </div><!-- /.container -->

  <div id="deviceIndicator" class="device-indicator"></div>

  <!-- è¿½åŠ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆä»Šã¯ãƒœã‚¿ãƒ³ã¯ç„¡ã„ãŒã€å°†æ¥ç”¨ã«æ®‹ã—ã¦ãŠãï¼‰ -->
  <div id="addDialog" class="dialog hidden">
    <div class="dialog-content">
      <h3>ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¿½åŠ </h3>
      <input id="addName"  placeholder="å•†å“å">
      <input id="addPrice" placeholder="ä¾¡æ ¼" type="number">
      <input id="addInfo"  placeholder="èª¬æ˜ï¼ˆä¾‹ï¼šè…¹50%ï¼‰">
      <select id="addGroup">
        <option value="food">é£Ÿã¹ç‰©</option>
        <option value="drink">é£²ã¿ç‰©</option>
      </select>
      <div style="display:flex; gap:10px; margin-top:8px;">
        <button class="btn small" id="addCancel"  style="flex:1;">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button class="btn small" id="addConfirm" style="flex:1;">è¿½åŠ </button>
      </div>
    </div>
  </div>

  <!-- å‰Šé™¤ãƒ€ã‚¤ã‚¢ãƒ­ã‚° -->
  <div id="deleteDialog" class="dialog hidden">
    <div class="dialog-content">
      <h3>å‰Šé™¤ç¢ºèª</h3>
      <div id="deleteTargetName" style="margin-bottom:10px;"></div>
      <div style="display:flex; gap:10px;">
        <button class="btn small" id="deleteCancel"  style="flex:1;">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button class="btn small" id="deleteConfirm" style="flex:1; background:rgba(185,74,74,0.35);">
          å‰Šé™¤ã™ã‚‹
        </button>
      </div>
    </div>
  </div>

  <!-- å›ºå®šãƒ•ãƒƒã‚¿ãƒ¼ï¼ˆåˆè¨ˆï¼‹ãƒªã‚»ãƒƒãƒˆï¼‰ -->
  <div class="total-bar">
    <div class="total-bar-inner">
      <div id="totalAmountFooter" class="total-text">åˆè¨ˆï¼šÂ¥0</div>
      <button id="footerResetBtn" class="reset-btn-footer">ãƒªã‚»ãƒƒãƒˆ</button>
    </div>
  </div>

</main>

<script>
/* ==========================
   åº—èˆ—ãƒ‡ãƒ¼ã‚¿
========================== */
const stores = {
  "Bar105": {
    displayName: "Bar105",
    menus: {
      food: [
        {name:"ã‚¢ãƒ’ãƒ¼ã‚¸ãƒ§", info:"è…¹50%", price:10000},
        {name:"ã‚Šã‚“ã”ã¨ã‚·ãƒŠãƒ¢ãƒ³ã®ã‚¹ãƒ†ã‚£ãƒƒã‚¯", info:"è…¹40%", price:6000},
        {name:"ã‚«ãƒ—ãƒ¬ãƒ¼ã‚¼", info:"è…¹35%", price:4500},
        {name:"ç”Ÿãƒãƒ ", info:"è…¹35%", price:4500},
        {name:"ã€åˆå¿ƒè€…æ¡ˆå†…é™å®šã€‘35%å›å¾©ãƒ•ãƒ¼ãƒ‰", info:"è…¹35%", price:3000},
        {name:"ãƒŸãƒƒã‚¯ã‚¹ãƒŠãƒƒãƒ„", info:"è…¹20%", price:3000},
        {name:"ã€ã‚³ãƒ©ãƒœã€‘ãƒ–ãƒ©ãƒ³ãƒ‡ãƒ¼ã‚±ãƒ¼ã‚­", info:"è…¹50%", price:18000},
        {name:"ã€Adminé™å®šã€‘ãƒ—ãƒªãƒ³ã‚¢ãƒªã‚¹ãƒ¢ãƒ¼ãƒ‰", info:"è…¹35%", price:8000},

      ],
      drink: [
        {name:"ãƒ†ã‚­ãƒ¼ãƒ©ã‚µãƒ³ãƒ©ã‚¤ã‚º", info:"æ°´åˆ†50%", price:15000},
        {name:"ãƒãƒ†ã‚£ãƒ¼ãƒ‹", info:"æ°´åˆ†50%", price:15000},
        {name:"ãƒãƒ³ãƒãƒƒã‚¿ãƒ³", info:"æ°´åˆ†50%", price:15000},
        {name:"ãƒ¢ãƒ’ãƒ¼ãƒˆ", info:"æ°´åˆ†40%", price:7000},
        {name:"ã‚¦ã‚£ã‚¹ã‚­ãƒ¼(ãƒ­ãƒƒã‚¯)", info:"æ°´åˆ†40%", price:7000},
        {name:"ã‚¸ãƒ³ãƒˆãƒ‹ãƒƒã‚¯", info:"æ°´åˆ†35%", price:5500},
        {name:"ã‚«ãƒ«ãƒ¼ã‚¢ãƒŸãƒ«ã‚¯", info:"æ°´åˆ†35%", price:5500},
        {name:"ãƒ•ã‚¡ã‚¸ãƒ¼ãƒãƒ¼ãƒ–ãƒ«", info:"æ°´åˆ†35%", price:5500},
        {name:"ã€åˆå¿ƒè€…æ¡ˆå†…é™å®šã€‘35%å›å¾©ãƒ‰ãƒªãƒ³ã‚¯", info:"æ°´åˆ†35%", price:3000},
        {name:"ã‚¯ãƒ©ãƒ•ãƒˆãƒ“ãƒ¼ãƒ«", info:"æ°´åˆ†20%", price:4000},
        {name:"ã€Adminé™å®šã€‘ãƒŸãƒã‚¹ã‚¢ãƒ­ãƒ¼ãƒ", info:"æ°´åˆ†35%", price:8000},
      ]
    }
  },
  "CLUB210": {
    displayName: "CLUB210",
    menus: {
      food: [
        {name:"ãƒ‰ãƒ©ã‚¤ãƒ•ãƒ«ãƒ¼ãƒ„", info:"è…¹50%", price:10000},
        {name:"ã‚ªãƒªãƒ¼ãƒ–", info:"è…¹40%", price:8000},
        {name:"ç”Ÿãƒãƒ§ã‚³", info:"è…¹35%", price:4500},
        {name:"ã€Adminé™å®šã€‘ã‚·ãƒ©ãƒŸãƒ¼ãƒˆãƒ‘ã‚¤", info:"è…¹35%", price:8000},
      ],
      drink: [
        {name:"ã‚·ãƒ£ãƒ³ãƒ‘ãƒ³", info:"æ°´åˆ†50%", price:21000},
        {name:"ãƒ†ã‚­ãƒ¼ãƒ©", info:"æ°´åˆ†40%", price:10000},
        {name:"ãƒ“ãƒ¼ãƒ«", info:"æ°´åˆ†35%", price:8000},
        {name:"ã€Adminé™å®šã€‘ãƒ‰ãƒ­ãƒ“ãƒ¼ãƒ•ã‚·ãƒãƒ¥ãƒ¼", info:"æ°´åˆ†35%", price:8000},
      ]
    }
  },
  "LOUNGE315": {
    displayName: "LOUNGE315",
    menus: {
      food: [
        {name:"ãƒ‘ãƒ—ãƒªã‚«ã®ãƒ‰ãƒªã‚¢", info:"è…¹50%", price:21000},
        {name:"ã‚«ãƒŠãƒƒãƒšï¼ˆãƒ”ãƒ³ãƒãƒ§ã‚¹ï¼‰", info:"è…¹35%", price:10500},
        {name:"ã€ã‚³ãƒ©ãƒœã€‘ã‚­ã‚»ãƒ«ãƒãƒ§ã‚³", info:"è…¹50%", price:18000},
        {name:"ã€Adminé™å®šã€‘ã‚µãƒ‘ãƒªã‚¨", info:"è…¹35%", price:8000},
      ],
      drink: [
        {name:"ã‚·ãƒ£ãƒ³ãƒ‘ãƒ³", info:"æ°´åˆ†50%", price:21000},
        {name:"ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒªãƒ³ã‚°ãƒ¯ã‚¤ãƒ³", info:"æ°´åˆ†40%", price:14700},
        {name:"ãƒ–ãƒ©ãƒ³ãƒ‡ãƒ¼", info:"æ°´åˆ†40%", price:14700},
        {name:"ãƒ¯ã‚¤ãƒ³", info:"æ°´åˆ†35%", price:10500},
        {name:"ã€Adminé™å®šã€‘ã‚·ãƒ£ã‚¯ãƒ‘ãƒ³", info:"æ°´åˆ†35%", price:8000},
      ]
    }
  }
};

/* ==========================
   åº—èˆ—ã‚­ãƒ¼åˆ¤å®š (?store=bar105 ç­‰)
========================== */
function getStoreFromURL(){
  const params = new URLSearchParams(location.search);
  const raw = params.get("store");
  if(!raw) return "Bar105";
  const lower = raw.toLowerCase();
  return Object.keys(stores).find(k => k.toLowerCase() === lower) || "Bar105";
}

const currentStoreKey = getStoreFromURL();
let currentStore = JSON.parse(JSON.stringify(stores[currentStoreKey]));

/* ==========================
   DOM å–å¾—
========================== */
const pageTitle       = document.getElementById("pageTitle");
const menuArea        = document.getElementById("menuArea");
const summaryEl       = document.getElementById("summary");
const deviceIndicator = document.getElementById("deviceIndicator");

const editModeBtn     = document.getElementById("editModeBtn");
const deviceToggleBtn = document.getElementById("deviceToggleBtn");

const addDialog       = document.getElementById("addDialog");
const addName         = document.getElementById("addName");
const addPrice        = document.getElementById("addPrice");
const addInfo         = document.getElementById("addInfo");
const addGroup        = document.getElementById("addGroup");
const addCancel       = document.getElementById("addCancel");
const addConfirm      = document.getElementById("addConfirm");

const deleteDialog    = document.getElementById("deleteDialog");
const deleteTargetName= document.getElementById("deleteTargetName");
const deleteCancel    = document.getElementById("deleteCancel");
const deleteConfirm   = document.getElementById("deleteConfirm");

const footerTotal     = document.getElementById("totalAmountFooter");
const footerResetBtn  = document.getElementById("footerResetBtn");

/* ==========================
   ã‚¿ã‚¤ãƒˆãƒ«
========================== */
pageTitle.textContent = `ğŸ¸ ${currentStore.displayName} â€” ã‚ªãƒ¼ãƒ€ãƒ¼è¨ˆç®—ãƒ„ãƒ¼ãƒ«`;

/* ==========================
   æ•°é‡ç®¡ç†
========================== */
const qtyMap = {};

function addQty(id, diff){
  qtyMap[id] = (qtyMap[id] || 0) + diff;
  if(qtyMap[id] < 0) qtyMap[id] = 0;

  const label = document.getElementById("qty_" + id);
  if(label) label.textContent = qtyMap[id];

  renderSummary();
}
window.addQty = addQty; // onclick ã‹ã‚‰å‘¼ã¹ã‚‹ã‚ˆã†ã«ã‚°ãƒ­ãƒ¼ãƒãƒ«å…¬é–‹

/* ==========================
   ãƒ¡ãƒ‹ãƒ¥ãƒ¼æç”»
========================== */
function renderMenus(){
  menuArea.innerHTML = "";

  ["food","drink"].forEach(group => {
    const groupBox = document.createElement("div");
    groupBox.className = "menu-group";

    groupBox.innerHTML = `
      <div class="menu-group-header">
        <h2>${group === "food" ? "ğŸ½ é£Ÿã¹ç‰©" : "ğŸ¥‚ é£²ã¿ç‰©"}</h2>
        <button class="btn small" onclick="sortGroup('${group}')">ä¾¡æ ¼ã§ä¸¦ã³æ›¿ãˆ</button>
      </div>
    `;

    currentStore.menus[group].forEach((item, index) => {
      const itemId = `${group}_${index}`;
      const itemEl = document.createElement("div");
      itemEl.className = "menu-item";

      itemEl.innerHTML = `
        <div class="top-line">
          <div class="name">${item.name}</div>
          <div class="price">Â¥${item.price.toLocaleString()}</div>
        </div>
        <div class="qty-label">${item.info}</div>
        <div class="controls-row">
          <div class="btn-row">
            <button class="qty-btn" onclick="addQty('${itemId}',1)">+1</button>
            <button class="qty-btn" onclick="addQty('${itemId}',5)">+5</button>
            <button class="qty-btn" onclick="addQty('${itemId}',10)">+10</button>
            <button class="qty-btn" onclick="addQty('${itemId}',50)">+50</button>

            <span id="qty_${itemId}" class="qty">0</span>

            <button class="qty-btn" onclick="addQty('${itemId}',-1)">-1</button>
            <button class="qty-btn" onclick="addQty('${itemId}',-5)">-5</button>
            <button class="qty-btn" onclick="addQty('${itemId}',-10)">-10</button>
            <button class="qty-btn" onclick="addQty('${itemId}',-50)">-50</button>
          </div>

          <button class="delete-btn" onclick="openDeleteDialog('${group}',${index})">å‰Šé™¤</button>
        </div>
      `;

      groupBox.appendChild(itemEl);
    });

    menuArea.appendChild(groupBox);
  });

  renderSummary();
}
renderMenus();

/* ==========================
   åˆè¨ˆã®è¨ˆç®—ãƒ»è¡¨ç¤º
========================== */
function renderSummary(){
  let total = 0;
  let html  = "";

  Object.keys(qtyMap).forEach(id => {
    const q = qtyMap[id];
    if(q <= 0) return;

    const [group, indexStr] = id.split("_");
    const idx  = Number(indexStr);
    const item = currentStore.menus[group][idx];
    if(!item) return;

    const sub = item.price * q;
    total += sub;

    html += `
      <div class="order-line">
        <span>${item.name} Ã— ${q}</span>
        <span>Â¥${sub.toLocaleString()}</span>
      </div>
    `;
  });

  summaryEl.innerHTML = html + `<div class="total">åˆè¨ˆï¼šÂ¥${total.toLocaleString()}</div>`;
  footerTotal.textContent = `åˆè¨ˆï¼šÂ¥${total.toLocaleString()}`;
}

/* ==========================
   ä¸¦ã³æ›¿ãˆ
========================== */
function sortGroup(group){
  currentStore.menus[group].sort((a,b) => a.price - b.price);
  renderMenus();
}
window.sortGroup = sortGroup;

/* ==========================
   å‰Šé™¤ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
========================== */
let deleteGroupKey = null;
let deleteIndexNum = null;

function openDeleteDialog(group, index){
  deleteGroupKey = group;
  deleteIndexNum = index;
  deleteTargetName.textContent =
    `ã€Œ${currentStore.menus[group][index].name}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`;
  deleteDialog.classList.remove("hidden");
}
window.openDeleteDialog = openDeleteDialog;

deleteCancel.onclick = () => {
  deleteDialog.classList.add("hidden");
};

deleteConfirm.onclick = () => {
  if(deleteGroupKey && deleteIndexNum !== null){
    currentStore.menus[deleteGroupKey].splice(deleteIndexNum,1);
    deleteDialog.classList.add("hidden");
    renderMenus();
  }
};

/* ==========================
   ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ï¼ˆå‰Šé™¤ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡ï¼‰
========================== */
let isEditMode = false;

editModeBtn.onclick = () => {
  isEditMode = !isEditMode;
  if(isEditMode){
    document.body.classList.add("edit-mode");
    editModeBtn.textContent = "ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ï¼šON";
  }else{
    document.body.classList.remove("edit-mode");
    editModeBtn.textContent = "ç·¨é›†ãƒ¢ãƒ¼ãƒ‰";
  }
};

/* ==========================
   è¿½åŠ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆä½¿ã†ãªã‚‰ï¼‰
========================== */
addCancel.onclick = () => {
  addDialog.classList.add("hidden");
};

addConfirm.onclick = () => {
  const name = addName.value.trim();
  const price= Number(addPrice.value);
  const info = addInfo.value.trim();
  const group= addGroup.value;

  if(!name || !price){
    alert("åå‰ã¨ä¾¡æ ¼ã¯å¿…é ˆã§ã™");
    return;
  }
  currentStore.menus[group].push({name, info, price});

  addName.value  = "";
  addPrice.value = "";
  addInfo.value  = "";

  addDialog.classList.add("hidden");
  renderMenus();
};

/* ==========================
   ãƒ‡ãƒã‚¤ã‚¹è¡¨ç¤ºåˆ‡æ›¿ï¼ˆãƒ©ãƒ™ãƒ«ç”¨ï¼‰
========================== */
let forcedMode = null; // "mobile" | "pc" | null(è‡ªå‹•)

function applyDeviceMode(){
  let isMobile;
  if(forcedMode === "mobile")      isMobile = true;
  else if(forcedMode === "pc")     isMobile = false;
  else                             isMobile = window.innerWidth < 600;

  deviceIndicator.textContent = isMobile ? "ğŸ“± ã‚¹ãƒãƒ›è¡¨ç¤º" : "ğŸ–¥ PCè¡¨ç¤º";

  if(isMobile) document.body.classList.add("mobile-mode");
  else         document.body.classList.remove("mobile-mode");
}

window.addEventListener("resize", applyDeviceMode);
applyDeviceMode();

deviceToggleBtn.onclick = () => {
  if(forcedMode === "mobile")      forcedMode = "pc";
  else if(forcedMode === "pc")     forcedMode = null;
  else                             forcedMode = "mobile";
  applyDeviceMode();
};

/* ==========================
   ãƒªã‚»ãƒƒãƒˆï¼ˆåˆè¨ˆï¼†æ•°é‡ å…¨ã‚¯ãƒªã‚¢ï¼‰
========================== */
function resetAll(){
  Object.keys(qtyMap).forEach(k => qtyMap[k] = 0);
  renderMenus();
}
footerResetBtn.onclick = resetAll;

</script>

</body>
</html>
